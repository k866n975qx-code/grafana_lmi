{
  "__inputs": [],
  "__requires": [
    { "type": "grafana", "id": "grafana", "name": "Grafana", "version": "10.0.0" }
  ],
  "annotations": { "list": [] },
  "editable": true,
  "graphTooltip": 0,
  "id": null,
  "panels": [
    {
      "id": 1,
      "type": "stat",
      "title": "Likely Tier",
      "gridPos": { "x": 0, "y": 0, "w": 4, "h": 5 },
      "datasource": { "type": "frser-sqlite-datasource", "uid": "lmi_sqlite" },
      "targets": [
        {
          "refId": "A", "format": "table", "queryType": "table",
          "queryText": "SELECT json_extract(payload_json, '$.goal_pace.likely_tier.tier') || ' - ' || json_extract(payload_json, '$.goal_pace.likely_tier.name') AS value FROM snapshot_daily_current ORDER BY as_of_date_local DESC LIMIT 1;",
          "rawQueryText": "SELECT json_extract(payload_json, '$.goal_pace.likely_tier.tier') || ' - ' || json_extract(payload_json, '$.goal_pace.likely_tier.name') AS value FROM snapshot_daily_current ORDER BY as_of_date_local DESC LIMIT 1;"
        }
      ],
      "options": {
        "colorMode": "background",
        "graphMode": "none",
        "orientation": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "value", "values": false },
        "textMode": "value",
        "wideLayout": true
      },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "fixed", "fixedColor": "blue" }
        },
        "overrides": []
      }
    },
    {
      "id": 2,
      "type": "stat",
      "title": "Pace Category",
      "gridPos": { "x": 4, "y": 0, "w": 4, "h": 5 },
      "datasource": { "type": "frser-sqlite-datasource", "uid": "lmi_sqlite" },
      "targets": [
        {
          "refId": "A", "format": "table", "queryType": "table",
          "queryText": "SELECT UPPER(json_extract(payload_json, '$.goal_pace.current_pace.pace_category')) AS value FROM snapshot_daily_current ORDER BY as_of_date_local DESC LIMIT 1;",
          "rawQueryText": "SELECT UPPER(json_extract(payload_json, '$.goal_pace.current_pace.pace_category')) AS value FROM snapshot_daily_current ORDER BY as_of_date_local DESC LIMIT 1;"
        }
      ],
      "options": {
        "colorMode": "background",
        "graphMode": "none",
        "orientation": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "value", "values": false },
        "textMode": "value",
        "wideLayout": true
      },
      "fieldConfig": {
        "defaults": {
          "mappings": [
            { "type": "value", "options": { "AHEAD": { "text": "AHEAD", "color": "green" }, "ON_TRACK": { "text": "ON TRACK", "color": "green" }, "BEHIND": { "text": "BEHIND", "color": "yellow" }, "OFF_TRACK": { "text": "OFF TRACK", "color": "red" } } }
          ]
        },
        "overrides": []
      }
    },
    {
      "id": 3,
      "type": "stat",
      "title": "Months Ahead / Behind",
      "gridPos": { "x": 8, "y": 0, "w": 4, "h": 5 },
      "datasource": { "type": "frser-sqlite-datasource", "uid": "lmi_sqlite" },
      "targets": [
        {
          "refId": "A", "format": "table", "queryType": "table",
          "queryText": "SELECT CAST(json_extract(payload_json, '$.goal_pace.current_pace.months_ahead_behind') AS REAL) AS value FROM snapshot_daily_current ORDER BY as_of_date_local DESC LIMIT 1;",
          "rawQueryText": "SELECT CAST(json_extract(payload_json, '$.goal_pace.current_pace.months_ahead_behind') AS REAL) AS value FROM snapshot_daily_current ORDER BY as_of_date_local DESC LIMIT 1;"
        }
      ],
      "options": {
        "colorMode": "value",
        "graphMode": "none",
        "orientation": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "value", "values": false },
        "textMode": "value_and_name",
        "wideLayout": true
      },
      "fieldConfig": {
        "defaults": {
          "unit": "none",
          "decimals": 1,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "value": null, "color": "red" },
              { "value": -3, "color": "yellow" },
              { "value": 0, "color": "green" }
            ]
          }
        },
        "overrides": []
      }
    },
    {
      "id": 4,
      "type": "stat",
      "title": "Revised Goal Date",
      "gridPos": { "x": 12, "y": 0, "w": 4, "h": 5 },
      "datasource": { "type": "frser-sqlite-datasource", "uid": "lmi_sqlite" },
      "targets": [
        {
          "refId": "A", "format": "table", "queryType": "table",
          "queryText": "SELECT json_extract(payload_json, '$.goal_pace.current_pace.revised_goal_date') AS value FROM snapshot_daily_current ORDER BY as_of_date_local DESC LIMIT 1;",
          "rawQueryText": "SELECT json_extract(payload_json, '$.goal_pace.current_pace.revised_goal_date') AS value FROM snapshot_daily_current ORDER BY as_of_date_local DESC LIMIT 1;"
        }
      ],
      "fieldConfig": { "defaults": {}, "overrides": [] }
    },
    {
      "id": 5,
      "type": "stat",
      "title": "Revised Months to Goal",
      "gridPos": { "x": 16, "y": 0, "w": 4, "h": 5 },
      "datasource": { "type": "frser-sqlite-datasource", "uid": "lmi_sqlite" },
      "targets": [
        {
          "refId": "A", "format": "table", "queryType": "table",
          "queryText": "SELECT CAST(json_extract(payload_json, '$.goal_pace.current_pace.revised_months_to_goal') AS INTEGER) AS value FROM snapshot_daily_current ORDER BY as_of_date_local DESC LIMIT 1;",
          "rawQueryText": "SELECT CAST(json_extract(payload_json, '$.goal_pace.current_pace.revised_months_to_goal') AS INTEGER) AS value FROM snapshot_daily_current ORDER BY as_of_date_local DESC LIMIT 1;"
        }
      ],
      "fieldConfig": { "defaults": { "unit": "none", "decimals": 0 }, "overrides": [] }
    },
    {
      "id": 6,
      "type": "stat",
      "title": "Confidence",
      "gridPos": { "x": 20, "y": 0, "w": 4, "h": 5 },
      "datasource": { "type": "frser-sqlite-datasource", "uid": "lmi_sqlite" },
      "targets": [
        {
          "refId": "A", "format": "table", "queryType": "table",
          "queryText": "SELECT UPPER(json_extract(payload_json, '$.goal_pace.likely_tier.confidence')) AS value FROM snapshot_daily_current ORDER BY as_of_date_local DESC LIMIT 1;",
          "rawQueryText": "SELECT UPPER(json_extract(payload_json, '$.goal_pace.likely_tier.confidence')) AS value FROM snapshot_daily_current ORDER BY as_of_date_local DESC LIMIT 1;"
        }
      ],
      "options": {
        "colorMode": "background",
        "graphMode": "none",
        "orientation": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "value", "values": false },
        "textMode": "value",
        "wideLayout": true
      },
      "fieldConfig": {
        "defaults": {
          "mappings": [
            { "type": "value", "options": { "HIGH": { "text": "HIGH", "color": "green" }, "MEDIUM": { "text": "MEDIUM", "color": "yellow" }, "LOW": { "text": "LOW", "color": "red" } } }
          ]
        },
        "overrides": []
      }
    },
    {
      "id": 7,
      "type": "stat",
      "title": "Portfolio Value",
      "gridPos": { "x": 0, "y": 5, "w": 6, "h": 5 },
      "datasource": { "type": "frser-sqlite-datasource", "uid": "lmi_sqlite" },
      "targets": [
        {
          "refId": "A", "format": "table", "queryType": "table",
          "queryText": "SELECT CAST(json_extract(payload_json, '$.goal_tiers.current_state.portfolio_value') AS REAL) AS value FROM snapshot_daily_current ORDER BY as_of_date_local DESC LIMIT 1;",
          "rawQueryText": "SELECT CAST(json_extract(payload_json, '$.goal_tiers.current_state.portfolio_value') AS REAL) AS value FROM snapshot_daily_current ORDER BY as_of_date_local DESC LIMIT 1;"
        }
      ],
      "fieldConfig": { "defaults": { "unit": "currencyUSD", "decimals": 0 }, "overrides": [] }
    },
    {
      "id": 8,
      "type": "stat",
      "title": "Required PV (Tier)",
      "gridPos": { "x": 6, "y": 5, "w": 6, "h": 5 },
      "datasource": { "type": "frser-sqlite-datasource", "uid": "lmi_sqlite" },
      "targets": [
        {
          "refId": "A", "format": "table", "queryType": "table",
          "queryText": "SELECT CAST(json_extract(payload_json, '$.goal_pace.baseline_projection.required_portfolio_value') AS REAL) AS value FROM snapshot_daily_current ORDER BY as_of_date_local DESC LIMIT 1;",
          "rawQueryText": "SELECT CAST(json_extract(payload_json, '$.goal_pace.baseline_projection.required_portfolio_value') AS REAL) AS value FROM snapshot_daily_current ORDER BY as_of_date_local DESC LIMIT 1;"
        }
      ],
      "fieldConfig": { "defaults": { "unit": "currencyUSD", "decimals": 0 }, "overrides": [] }
    },
    {
      "id": 9,
      "type": "stat",
      "title": "Current Monthly Income",
      "gridPos": { "x": 12, "y": 5, "w": 6, "h": 5 },
      "datasource": { "type": "frser-sqlite-datasource", "uid": "lmi_sqlite" },
      "targets": [
        {
          "refId": "A", "format": "table", "queryType": "table",
          "queryText": "SELECT CAST(json_extract(payload_json, '$.goal_tiers.current_state.projected_monthly_income') AS REAL) AS value FROM snapshot_daily_current ORDER BY as_of_date_local DESC LIMIT 1;",
          "rawQueryText": "SELECT CAST(json_extract(payload_json, '$.goal_tiers.current_state.projected_monthly_income') AS REAL) AS value FROM snapshot_daily_current ORDER BY as_of_date_local DESC LIMIT 1;"
        }
      ],
      "fieldConfig": { "defaults": { "unit": "currencyUSD", "decimals": 0 }, "overrides": [] }
    },
    {
      "id": 10,
      "type": "stat",
      "title": "Target Monthly",
      "gridPos": { "x": 18, "y": 5, "w": 6, "h": 5 },
      "datasource": { "type": "frser-sqlite-datasource", "uid": "lmi_sqlite" },
      "targets": [
        {
          "refId": "A", "format": "table", "queryType": "table",
          "queryText": "SELECT CAST(json_extract(payload_json, '$.goal_tiers.current_state.target_monthly') AS REAL) AS value FROM snapshot_daily_current ORDER BY as_of_date_local DESC LIMIT 1;",
          "rawQueryText": "SELECT CAST(json_extract(payload_json, '$.goal_tiers.current_state.target_monthly') AS REAL) AS value FROM snapshot_daily_current ORDER BY as_of_date_local DESC LIMIT 1;"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "currencyUSD",
          "decimals": 0,
          "color": { "mode": "fixed", "fixedColor": "orange" }
        },
        "overrides": []
      }
    },
    {
      "id": 11,
      "type": "table",
      "title": "Goal Tier Roadmap",
      "description": "All 6 tiers with projections. The likely tier (auto-detected from your behavior) is highlighted.",
      "gridPos": { "x": 0, "y": 10, "w": 24, "h": 12 },
      "datasource": { "type": "frser-sqlite-datasource", "uid": "lmi_sqlite" },
      "targets": [
        {
          "refId": "A", "format": "table", "queryType": "table",
          "queryText": "WITH latest AS (SELECT payload_json FROM snapshot_daily_current ORDER BY as_of_date_local DESC LIMIT 1) SELECT CAST(json_extract(t.value, '$.tier') AS INTEGER) AS tier, json_extract(t.value, '$.name') AS name, CAST(json_extract(t.value, '$.months_to_goal') AS INTEGER) AS months_to_goal, json_extract(t.value, '$.estimated_goal_date') AS goal_date, CAST(json_extract(t.value, '$.required_portfolio_value') AS REAL) AS required_pv, CAST(json_extract(t.value, '$.additional_investment_needed') AS REAL) AS additional_needed, CASE WHEN json_extract(t.value, '$.assumptions.drip_enabled') THEN 'Yes' ELSE 'No' END AS drip, CAST(json_extract(t.value, '$.assumptions.monthly_contribution') AS REAL) AS monthly_contrib, CAST(json_extract(t.value, '$.assumptions.annual_appreciation_pct') AS REAL) AS appreciation_pct, CASE WHEN json_extract(t.value, '$.assumptions.ltv_maintained') THEN 'Yes' ELSE 'No' END AS leverage, CASE WHEN CAST(json_extract(t.value, '$.tier') AS INTEGER) = CAST(json_extract(latest.payload_json, '$.goal_pace.likely_tier.tier') AS INTEGER) THEN 'CURRENT' ELSE '' END AS active FROM latest, json_each(latest.payload_json, '$.goal_tiers.tiers') AS t ORDER BY CAST(json_extract(t.value, '$.tier') AS INTEGER);",
          "rawQueryText": "WITH latest AS (SELECT payload_json FROM snapshot_daily_current ORDER BY as_of_date_local DESC LIMIT 1) SELECT CAST(json_extract(t.value, '$.tier') AS INTEGER) AS tier, json_extract(t.value, '$.name') AS name, CAST(json_extract(t.value, '$.months_to_goal') AS INTEGER) AS months_to_goal, json_extract(t.value, '$.estimated_goal_date') AS goal_date, CAST(json_extract(t.value, '$.required_portfolio_value') AS REAL) AS required_pv, CAST(json_extract(t.value, '$.additional_investment_needed') AS REAL) AS additional_needed, CASE WHEN json_extract(t.value, '$.assumptions.drip_enabled') THEN 'Yes' ELSE 'No' END AS drip, CAST(json_extract(t.value, '$.assumptions.monthly_contribution') AS REAL) AS monthly_contrib, CAST(json_extract(t.value, '$.assumptions.annual_appreciation_pct') AS REAL) AS appreciation_pct, CASE WHEN json_extract(t.value, '$.assumptions.ltv_maintained') THEN 'Yes' ELSE 'No' END AS leverage, CASE WHEN CAST(json_extract(t.value, '$.tier') AS INTEGER) = CAST(json_extract(latest.payload_json, '$.goal_pace.likely_tier.tier') AS INTEGER) THEN 'CURRENT' ELSE '' END AS active FROM latest, json_each(latest.payload_json, '$.goal_tiers.tiers') AS t ORDER BY CAST(json_extract(t.value, '$.tier') AS INTEGER);"
        }
      ],
      "options": { "showHeader": true, "cellHeight": "md" },
      "fieldConfig": {
        "defaults": {},
        "overrides": [
          { "matcher": { "id": "byName", "options": "required_pv" }, "properties": [{ "id": "unit", "value": "currencyUSD" }, { "id": "decimals", "value": 0 }, { "id": "displayName", "value": "Required PV" }] },
          { "matcher": { "id": "byName", "options": "additional_needed" }, "properties": [{ "id": "unit", "value": "currencyUSD" }, { "id": "decimals", "value": 0 }, { "id": "displayName", "value": "Additional Needed" }] },
          { "matcher": { "id": "byName", "options": "monthly_contrib" }, "properties": [{ "id": "unit", "value": "currencyUSD" }, { "id": "decimals", "value": 0 }, { "id": "displayName", "value": "Monthly Contrib" }] },
          { "matcher": { "id": "byName", "options": "appreciation_pct" }, "properties": [{ "id": "unit", "value": "percent" }, { "id": "decimals", "value": 1 }, { "id": "displayName", "value": "Apprec %" }] },
          { "matcher": { "id": "byName", "options": "months_to_goal" }, "properties": [{ "id": "displayName", "value": "Months" }] },
          { "matcher": { "id": "byName", "options": "goal_date" }, "properties": [{ "id": "displayName", "value": "Goal Date" }] },
          { "matcher": { "id": "byName", "options": "tier" }, "properties": [{ "id": "displayName", "value": "Tier" }] },
          { "matcher": { "id": "byName", "options": "name" }, "properties": [{ "id": "displayName", "value": "Name" }] },
          { "matcher": { "id": "byName", "options": "drip" }, "properties": [{ "id": "displayName", "value": "DRIP" }] },
          { "matcher": { "id": "byName", "options": "leverage" }, "properties": [{ "id": "displayName", "value": "Leverage" }] },
          {
            "matcher": { "id": "byName", "options": "active" },
            "properties": [
              { "id": "displayName", "value": "Active" },
              { "id": "mappings", "value": [{ "type": "value", "options": { "CURRENT": { "text": "CURRENT", "color": "green" } } }] },
              { "id": "custom.cellOptions", "value": { "type": "color-background" } }
            ]
          }
        ]
      }
    },
    {
      "id": 12,
      "type": "table",
      "title": "Pace Tracking Windows",
      "description": "Expected vs actual performance across multiple time windows based on your likely tier projection.",
      "gridPos": { "x": 0, "y": 22, "w": 24, "h": 12 },
      "datasource": { "type": "frser-sqlite-datasource", "uid": "lmi_sqlite" },
      "targets": [
        {
          "refId": "A", "format": "table", "queryType": "table",
          "queryText": "WITH latest AS (SELECT payload_json FROM snapshot_daily_current ORDER BY as_of_date_local DESC LIMIT 1), windows AS (SELECT w.key AS wk, w.value AS wd FROM latest, json_each(latest.payload_json, '$.goal_pace.windows') AS w) SELECT json_extract(wd, '$.window_name') AS window, CAST(json_extract(wd, '$.days_in_window') AS INTEGER) AS days, CAST(json_extract(wd, '$.expected.portfolio_value') AS REAL) AS expected_pv, CAST(json_extract(wd, '$.actual.portfolio_value') AS REAL) AS actual_pv, CAST(json_extract(wd, '$.delta.portfolio_value') AS REAL) AS pv_delta, CAST(json_extract(wd, '$.delta.portfolio_value_pct') AS REAL) AS pv_delta_pct, CAST(json_extract(wd, '$.expected.monthly_income') AS REAL) AS expected_income, CAST(json_extract(wd, '$.actual.monthly_income') AS REAL) AS actual_income, CAST(json_extract(wd, '$.pace.months_ahead_behind') AS REAL) AS months_ahead_behind, CAST(json_extract(wd, '$.pace.pct_of_tier_pace') AS REAL) AS pace_pct, CAST(json_extract(wd, '$.pace.amount_surplus') AS REAL) AS surplus FROM windows ORDER BY CAST(json_extract(wd, '$.days_in_window') AS INTEGER);",
          "rawQueryText": "WITH latest AS (SELECT payload_json FROM snapshot_daily_current ORDER BY as_of_date_local DESC LIMIT 1), windows AS (SELECT w.key AS wk, w.value AS wd FROM latest, json_each(latest.payload_json, '$.goal_pace.windows') AS w) SELECT json_extract(wd, '$.window_name') AS window, CAST(json_extract(wd, '$.days_in_window') AS INTEGER) AS days, CAST(json_extract(wd, '$.expected.portfolio_value') AS REAL) AS expected_pv, CAST(json_extract(wd, '$.actual.portfolio_value') AS REAL) AS actual_pv, CAST(json_extract(wd, '$.delta.portfolio_value') AS REAL) AS pv_delta, CAST(json_extract(wd, '$.delta.portfolio_value_pct') AS REAL) AS pv_delta_pct, CAST(json_extract(wd, '$.expected.monthly_income') AS REAL) AS expected_income, CAST(json_extract(wd, '$.actual.monthly_income') AS REAL) AS actual_income, CAST(json_extract(wd, '$.pace.months_ahead_behind') AS REAL) AS months_ahead_behind, CAST(json_extract(wd, '$.pace.pct_of_tier_pace') AS REAL) AS pace_pct, CAST(json_extract(wd, '$.pace.amount_surplus') AS REAL) AS surplus FROM windows ORDER BY CAST(json_extract(wd, '$.days_in_window') AS INTEGER);"
        }
      ],
      "options": { "showHeader": true, "cellHeight": "md" },
      "fieldConfig": {
        "defaults": {},
        "overrides": [
          { "matcher": { "id": "byName", "options": "window" }, "properties": [{ "id": "displayName", "value": "Window" }] },
          { "matcher": { "id": "byName", "options": "days" }, "properties": [{ "id": "displayName", "value": "Days" }] },
          { "matcher": { "id": "byName", "options": "expected_pv" }, "properties": [{ "id": "unit", "value": "currencyUSD" }, { "id": "decimals", "value": 0 }, { "id": "displayName", "value": "Expected PV" }] },
          { "matcher": { "id": "byName", "options": "actual_pv" }, "properties": [{ "id": "unit", "value": "currencyUSD" }, { "id": "decimals", "value": 0 }, { "id": "displayName", "value": "Actual PV" }] },
          { "matcher": { "id": "byName", "options": "pv_delta" }, "properties": [{ "id": "unit", "value": "currencyUSD" }, { "id": "decimals", "value": 0 }, { "id": "displayName", "value": "PV Delta" }] },
          { "matcher": { "id": "byName", "options": "pv_delta_pct" }, "properties": [{ "id": "unit", "value": "percent" }, { "id": "decimals", "value": 1 }, { "id": "displayName", "value": "PV Delta %" }] },
          { "matcher": { "id": "byName", "options": "expected_income" }, "properties": [{ "id": "unit", "value": "currencyUSD" }, { "id": "decimals", "value": 0 }, { "id": "displayName", "value": "Exp. Income" }] },
          { "matcher": { "id": "byName", "options": "actual_income" }, "properties": [{ "id": "unit", "value": "currencyUSD" }, { "id": "decimals", "value": 0 }, { "id": "displayName", "value": "Act. Income" }] },
          {
            "matcher": { "id": "byName", "options": "months_ahead_behind" },
            "properties": [
              { "id": "displayName", "value": "Months +/-" },
              { "id": "decimals", "value": 1 },
              { "id": "thresholds", "value": { "mode": "absolute", "steps": [{ "value": null, "color": "red" }, { "value": -3, "color": "yellow" }, { "value": 0, "color": "green" }] } },
              { "id": "custom.cellOptions", "value": { "type": "color-text" } }
            ]
          },
          { "matcher": { "id": "byName", "options": "pace_pct" }, "properties": [{ "id": "unit", "value": "percent" }, { "id": "decimals", "value": 1 }, { "id": "displayName", "value": "Pace %" }] },
          { "matcher": { "id": "byName", "options": "surplus" }, "properties": [{ "id": "unit", "value": "currencyUSD" }, { "id": "decimals", "value": 0 }, { "id": "displayName", "value": "Surplus" }] }
        ]
      }
    },
    {
      "id": 13,
      "type": "timeseries",
      "title": "Portfolio Value vs Expected Pace (180d)",
      "description": "Actual portfolio value overlaid with the expected trajectory from your likely tier projection.",
      "gridPos": { "x": 0, "y": 34, "w": 24, "h": 10 },
      "datasource": { "type": "frser-sqlite-datasource", "uid": "lmi_sqlite" },
      "targets": [
        {
          "refId": "A", "format": "table", "queryType": "table",
          "queryText": "SELECT (as_of_date_local || 'T00:00:00Z') AS time, CAST(json_extract(payload_json, '$.totals.market_value') AS REAL) AS \"Actual Portfolio Value\", CAST(json_extract(payload_json, '$.goal_pace.windows.since_inception.expected.portfolio_value') AS REAL) AS \"Expected (Tier Pace)\" FROM snapshot_daily_current WHERE as_of_date_local >= date('now', '-180 day') ORDER BY as_of_date_local;",
          "rawQueryText": "SELECT (as_of_date_local || 'T00:00:00Z') AS time, CAST(json_extract(payload_json, '$.totals.market_value') AS REAL) AS \"Actual Portfolio Value\", CAST(json_extract(payload_json, '$.goal_pace.windows.since_inception.expected.portfolio_value') AS REAL) AS \"Expected (Tier Pace)\" FROM snapshot_daily_current WHERE as_of_date_local >= date('now', '-180 day') ORDER BY as_of_date_local;"
        }
      ],
      "transformations": [
        { "id": "convertFieldType", "options": { "conversions": [{ "targetField": "time", "destinationType": "time" }] } }
      ],
      "options": {
        "tooltip": { "mode": "multi" },
        "legend": { "displayMode": "list", "placement": "bottom" }
      },
      "fieldConfig": {
        "defaults": { "unit": "currencyUSD", "decimals": 0 },
        "overrides": [
          {
            "matcher": { "id": "byName", "options": "Actual Portfolio Value" },
            "properties": [
              { "id": "color", "value": { "mode": "fixed", "fixedColor": "green" } },
              { "id": "custom.fillOpacity", "value": 10 },
              { "id": "custom.lineWidth", "value": 2 }
            ]
          },
          {
            "matcher": { "id": "byName", "options": "Expected (Tier Pace)" },
            "properties": [
              { "id": "color", "value": { "mode": "fixed", "fixedColor": "blue" } },
              { "id": "custom.lineStyle", "value": { "fill": "dash", "dash": [10, 5] } },
              { "id": "custom.lineWidth", "value": 1 }
            ]
          }
        ]
      }
    },
    {
      "id": 14,
      "type": "timeseries",
      "title": "Monthly Income vs Target (180d)",
      "description": "Actual projected monthly income trending toward the target goal.",
      "gridPos": { "x": 0, "y": 44, "w": 24, "h": 10 },
      "datasource": { "type": "frser-sqlite-datasource", "uid": "lmi_sqlite" },
      "targets": [
        {
          "refId": "A", "format": "table", "queryType": "table",
          "queryText": "SELECT (as_of_date_local || 'T00:00:00Z') AS time, CAST(json_extract(payload_json, '$.income.projected_monthly_income') AS REAL) AS \"Monthly Income\", CAST(json_extract(payload_json, '$.goal_tiers.current_state.target_monthly') AS REAL) AS \"Target ($4,000/mo)\" FROM snapshot_daily_current WHERE as_of_date_local >= date('now', '-180 day') ORDER BY as_of_date_local;",
          "rawQueryText": "SELECT (as_of_date_local || 'T00:00:00Z') AS time, CAST(json_extract(payload_json, '$.income.projected_monthly_income') AS REAL) AS \"Monthly Income\", CAST(json_extract(payload_json, '$.goal_tiers.current_state.target_monthly') AS REAL) AS \"Target ($4,000/mo)\" FROM snapshot_daily_current WHERE as_of_date_local >= date('now', '-180 day') ORDER BY as_of_date_local;"
        }
      ],
      "transformations": [
        { "id": "convertFieldType", "options": { "conversions": [{ "targetField": "time", "destinationType": "time" }] } }
      ],
      "options": {
        "tooltip": { "mode": "multi" },
        "legend": { "displayMode": "list", "placement": "bottom" }
      },
      "fieldConfig": {
        "defaults": { "unit": "currencyUSD", "decimals": 0 },
        "overrides": [
          {
            "matcher": { "id": "byName", "options": "Monthly Income" },
            "properties": [
              { "id": "color", "value": { "mode": "fixed", "fixedColor": "green" } },
              { "id": "custom.fillOpacity", "value": 20 },
              { "id": "custom.lineWidth", "value": 2 }
            ]
          },
          {
            "matcher": { "id": "byName", "options": "Target ($4,000/mo)" },
            "properties": [
              { "id": "color", "value": { "mode": "fixed", "fixedColor": "red" } },
              { "id": "custom.lineStyle", "value": { "fill": "dash", "dash": [10, 5] } },
              { "id": "custom.lineWidth", "value": 2 }
            ]
          }
        ]
      }
    },
    {
      "id": 15,
      "type": "timeseries",
      "title": "Goal Progress % Trend (180d)",
      "description": "Progress toward income goal over time - gross vs net (after margin interest).",
      "gridPos": { "x": 0, "y": 54, "w": 12, "h": 8 },
      "datasource": { "type": "frser-sqlite-datasource", "uid": "lmi_sqlite" },
      "targets": [
        {
          "refId": "A", "format": "table", "queryType": "table",
          "queryText": "SELECT (as_of_date_local || 'T00:00:00Z') AS time, CAST(json_extract(payload_json, '$.goal_progress.progress_pct') AS REAL) AS \"Gross Progress %\", CAST(json_extract(payload_json, '$.goal_progress_net.progress_pct') AS REAL) AS \"Net Progress %\" FROM snapshot_daily_current WHERE as_of_date_local >= date('now', '-180 day') ORDER BY as_of_date_local;",
          "rawQueryText": "SELECT (as_of_date_local || 'T00:00:00Z') AS time, CAST(json_extract(payload_json, '$.goal_progress.progress_pct') AS REAL) AS \"Gross Progress %\", CAST(json_extract(payload_json, '$.goal_progress_net.progress_pct') AS REAL) AS \"Net Progress %\" FROM snapshot_daily_current WHERE as_of_date_local >= date('now', '-180 day') ORDER BY as_of_date_local;"
        }
      ],
      "transformations": [
        { "id": "convertFieldType", "options": { "conversions": [{ "targetField": "time", "destinationType": "time" }] } }
      ],
      "options": {
        "tooltip": { "mode": "multi" },
        "legend": { "displayMode": "list", "placement": "bottom" }
      },
      "fieldConfig": {
        "defaults": { "unit": "percent", "decimals": 1 },
        "overrides": [
          { "matcher": { "id": "byName", "options": "Gross Progress %" }, "properties": [{ "id": "color", "value": { "mode": "fixed", "fixedColor": "green" } }] },
          { "matcher": { "id": "byName", "options": "Net Progress %" }, "properties": [{ "id": "color", "value": { "mode": "fixed", "fixedColor": "orange" } }] }
        ]
      }
    },
    {
      "id": 16,
      "type": "timeseries",
      "title": "Months to Goal Trend (180d)",
      "description": "Tracking how quickly you're approaching the goal. Lower is better.",
      "gridPos": { "x": 12, "y": 54, "w": 12, "h": 8 },
      "datasource": { "type": "frser-sqlite-datasource", "uid": "lmi_sqlite" },
      "targets": [
        {
          "refId": "A", "format": "table", "queryType": "table",
          "queryText": "SELECT (as_of_date_local || 'T00:00:00Z') AS time, CAST(json_extract(payload_json, '$.goal_progress.months_to_goal') AS REAL) AS \"Months to Goal\" FROM snapshot_daily_current WHERE as_of_date_local >= date('now', '-180 day') ORDER BY as_of_date_local;",
          "rawQueryText": "SELECT (as_of_date_local || 'T00:00:00Z') AS time, CAST(json_extract(payload_json, '$.goal_progress.months_to_goal') AS REAL) AS \"Months to Goal\" FROM snapshot_daily_current WHERE as_of_date_local >= date('now', '-180 day') ORDER BY as_of_date_local;"
        }
      ],
      "transformations": [
        { "id": "convertFieldType", "options": { "conversions": [{ "targetField": "time", "destinationType": "time" }] } }
      ],
      "options": {
        "tooltip": { "mode": "multi" },
        "legend": { "displayMode": "list", "placement": "bottom" }
      },
      "fieldConfig": {
        "defaults": { "unit": "none", "decimals": 0 },
        "overrides": [
          { "matcher": { "id": "byName", "options": "Months to Goal" }, "properties": [{ "id": "color", "value": { "mode": "fixed", "fixedColor": "purple" } }, { "id": "custom.fillOpacity", "value": 10 }] }
        ]
      }
    },
    {
      "id": 17,
      "type": "stat",
      "title": "Future APR Impact",
      "description": "Net progress % when margin rate changes to future APR.",
      "gridPos": { "x": 0, "y": 62, "w": 8, "h": 5 },
      "datasource": { "type": "frser-sqlite-datasource", "uid": "lmi_sqlite" },
      "targets": [
        {
          "refId": "A", "format": "table", "queryType": "table",
          "queryText": "SELECT CAST(json_extract(payload_json, '$.goal_progress_net.future_rate_sensitivity.apr_future_pct') AS REAL) || '% APR -> ' || CAST(json_extract(payload_json, '$.goal_progress_net.future_rate_sensitivity.progress_pct_future') AS TEXT) || '% progress' AS value FROM snapshot_daily_current ORDER BY as_of_date_local DESC LIMIT 1;",
          "rawQueryText": "SELECT CAST(json_extract(payload_json, '$.goal_progress_net.future_rate_sensitivity.apr_future_pct') AS REAL) || '% APR -> ' || CAST(json_extract(payload_json, '$.goal_progress_net.future_rate_sensitivity.progress_pct_future') AS TEXT) || '% progress' AS value FROM snapshot_daily_current ORDER BY as_of_date_local DESC LIMIT 1;"
        }
      ],
      "options": {
        "colorMode": "background",
        "graphMode": "none",
        "orientation": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "value", "values": false },
        "textMode": "value",
        "wideLayout": true
      },
      "fieldConfig": {
        "defaults": { "color": { "mode": "fixed", "fixedColor": "yellow" } },
        "overrides": []
      }
    },
    {
      "id": 18,
      "type": "stat",
      "title": "Future Monthly Interest",
      "gridPos": { "x": 8, "y": 62, "w": 8, "h": 5 },
      "datasource": { "type": "frser-sqlite-datasource", "uid": "lmi_sqlite" },
      "targets": [
        {
          "refId": "A", "format": "table", "queryType": "table",
          "queryText": "SELECT CAST(json_extract(payload_json, '$.goal_progress_net.future_rate_sensitivity.monthly_interest_future') AS REAL) AS value FROM snapshot_daily_current ORDER BY as_of_date_local DESC LIMIT 1;",
          "rawQueryText": "SELECT CAST(json_extract(payload_json, '$.goal_progress_net.future_rate_sensitivity.monthly_interest_future') AS REAL) AS value FROM snapshot_daily_current ORDER BY as_of_date_local DESC LIMIT 1;"
        }
      ],
      "fieldConfig": {
        "defaults": { "unit": "currencyUSD", "decimals": 2, "color": { "mode": "fixed", "fixedColor": "yellow" } },
        "overrides": []
      }
    },
    {
      "id": 19,
      "type": "stat",
      "title": "Additional Needed (Future Rate)",
      "gridPos": { "x": 16, "y": 62, "w": 8, "h": 5 },
      "datasource": { "type": "frser-sqlite-datasource", "uid": "lmi_sqlite" },
      "targets": [
        {
          "refId": "A", "format": "table", "queryType": "table",
          "queryText": "SELECT CAST(json_extract(payload_json, '$.goal_progress_net.future_rate_sensitivity.additional_investment_needed_future') AS REAL) AS value FROM snapshot_daily_current ORDER BY as_of_date_local DESC LIMIT 1;",
          "rawQueryText": "SELECT CAST(json_extract(payload_json, '$.goal_progress_net.future_rate_sensitivity.additional_investment_needed_future') AS REAL) AS value FROM snapshot_daily_current ORDER BY as_of_date_local DESC LIMIT 1;"
        }
      ],
      "fieldConfig": {
        "defaults": { "unit": "currencyUSD", "decimals": 0 },
        "overrides": []
      }
    }
  ],
  "refresh": "2m",
  "schemaVersion": 39,
  "style": "dark",
  "tags": ["lmi", "goals"],
  "time": { "from": "now-180d", "to": "now" },
  "timezone": "browser",
  "title": "LMI - Goal Tiers & Pace",
  "uid": "lmi-goal-tiers",
  "version": 1
}
