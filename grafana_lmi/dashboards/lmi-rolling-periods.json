{
  "__inputs": [],
  "__requires": [
    { "type": "grafana", "id": "grafana", "name": "Grafana", "version": "10.0.0" }
  ],
  "annotations": { "list": [] },
  "editable": true,
  "graphTooltip": 0,
  "id": null,
  "panels": [
    {
      "id": 100,
      "type": "row",
      "title": "Week-to-Date",
      "gridPos": { "x": 0, "y": 0, "w": 24, "h": 1 },
      "collapsed": false
    },
    {
      "id": 1,
      "type": "stat",
      "title": "WTD Range",
      "gridPos": { "x": 0, "y": 1, "w": 6, "h": 4 },
      "datasource": { "type": "frser-sqlite-datasource", "uid": "lmi_sqlite" },
      "targets": [{ "refId": "A", "format": "table", "queryType": "table",
        "queryText": "SELECT period_start_date || '  ->  ' || period_end_date AS value FROM snapshots WHERE period_type = 'WEEK_ROLLING' ORDER BY period_end_date DESC LIMIT 1;",
        "rawQueryText": "SELECT period_start_date || '  ->  ' || period_end_date AS value FROM snapshots WHERE period_type = 'WEEK_ROLLING' ORDER BY period_end_date DESC LIMIT 1;"
      }],
      "fieldConfig": { "defaults": {}, "overrides": [] }
    },
    {
      "id": 2,
      "type": "stat",
      "title": "WTD MV Delta",
      "gridPos": { "x": 6, "y": 1, "w": 6, "h": 4 },
      "datasource": { "type": "frser-sqlite-datasource", "uid": "lmi_sqlite" },
      "targets": [{ "refId": "A", "format": "table", "queryType": "table",
        "queryText": "SELECT CAST(json_extract(payload_json, '$.period_summary.totals.delta.total_market_value') AS REAL) AS value FROM snapshots WHERE period_type = 'WEEK_ROLLING' ORDER BY period_end_date DESC LIMIT 1;",
        "rawQueryText": "SELECT CAST(json_extract(payload_json, '$.period_summary.totals.delta.total_market_value') AS REAL) AS value FROM snapshots WHERE period_type = 'WEEK_ROLLING' ORDER BY period_end_date DESC LIMIT 1;"
      }],
      "options": { "colorMode": "value", "graphMode": "none", "reduceOptions": { "calcs": ["lastNotNull"], "fields": "value", "values": false }, "textMode": "value_and_name" },
      "fieldConfig": { "defaults": { "unit": "currencyUSD", "decimals": 0, "thresholds": { "mode": "absolute", "steps": [{ "value": null, "color": "red" }, { "value": 0, "color": "green" }] } }, "overrides": [] }
    },
    {
      "id": 3,
      "type": "stat",
      "title": "WTD Income Delta",
      "gridPos": { "x": 12, "y": 1, "w": 6, "h": 4 },
      "datasource": { "type": "frser-sqlite-datasource", "uid": "lmi_sqlite" },
      "targets": [{ "refId": "A", "format": "table", "queryType": "table",
        "queryText": "SELECT CAST(json_extract(payload_json, '$.period_summary.income.delta.projected_monthly_income') AS REAL) AS value FROM snapshots WHERE period_type = 'WEEK_ROLLING' ORDER BY period_end_date DESC LIMIT 1;",
        "rawQueryText": "SELECT CAST(json_extract(payload_json, '$.period_summary.income.delta.projected_monthly_income') AS REAL) AS value FROM snapshots WHERE period_type = 'WEEK_ROLLING' ORDER BY period_end_date DESC LIMIT 1;"
      }],
      "options": { "colorMode": "value", "graphMode": "none", "reduceOptions": { "calcs": ["lastNotNull"], "fields": "value", "values": false }, "textMode": "value_and_name" },
      "fieldConfig": { "defaults": { "unit": "currencyUSD", "decimals": 0, "thresholds": { "mode": "absolute", "steps": [{ "value": null, "color": "red" }, { "value": 0, "color": "green" }] } }, "overrides": [] }
    },
    {
      "id": 4,
      "type": "stat",
      "title": "WTD TWR %",
      "gridPos": { "x": 18, "y": 1, "w": 6, "h": 4 },
      "datasource": { "type": "frser-sqlite-datasource", "uid": "lmi_sqlite" },
      "targets": [{ "refId": "A", "format": "table", "queryType": "table",
        "queryText": "SELECT CAST(json_extract(payload_json, '$.period_summary.performance.period.twr_period_pct') AS REAL) AS value FROM snapshots WHERE period_type = 'WEEK_ROLLING' ORDER BY period_end_date DESC LIMIT 1;",
        "rawQueryText": "SELECT CAST(json_extract(payload_json, '$.period_summary.performance.period.twr_period_pct') AS REAL) AS value FROM snapshots WHERE period_type = 'WEEK_ROLLING' ORDER BY period_end_date DESC LIMIT 1;"
      }],
      "options": { "colorMode": "value", "graphMode": "none", "reduceOptions": { "calcs": ["lastNotNull"], "fields": "value", "values": false }, "textMode": "value_and_name" },
      "fieldConfig": { "defaults": { "unit": "percent", "decimals": 2, "thresholds": { "mode": "absolute", "steps": [{ "value": null, "color": "red" }, { "value": 0, "color": "green" }] } }, "overrides": [] }
    },
    {
      "id": 101,
      "type": "row",
      "title": "Month-to-Date",
      "gridPos": { "x": 0, "y": 5, "w": 24, "h": 1 },
      "collapsed": false
    },
    {
      "id": 5,
      "type": "stat",
      "title": "MTD Range",
      "gridPos": { "x": 0, "y": 6, "w": 6, "h": 4 },
      "datasource": { "type": "frser-sqlite-datasource", "uid": "lmi_sqlite" },
      "targets": [{ "refId": "A", "format": "table", "queryType": "table",
        "queryText": "SELECT period_start_date || '  ->  ' || period_end_date AS value FROM snapshots WHERE period_type = 'MONTH_ROLLING' ORDER BY period_end_date DESC LIMIT 1;",
        "rawQueryText": "SELECT period_start_date || '  ->  ' || period_end_date AS value FROM snapshots WHERE period_type = 'MONTH_ROLLING' ORDER BY period_end_date DESC LIMIT 1;"
      }],
      "fieldConfig": { "defaults": {}, "overrides": [] }
    },
    {
      "id": 6,
      "type": "stat",
      "title": "MTD MV Delta",
      "gridPos": { "x": 6, "y": 6, "w": 6, "h": 4 },
      "datasource": { "type": "frser-sqlite-datasource", "uid": "lmi_sqlite" },
      "targets": [{ "refId": "A", "format": "table", "queryType": "table",
        "queryText": "SELECT CAST(json_extract(payload_json, '$.period_summary.totals.delta.total_market_value') AS REAL) AS value FROM snapshots WHERE period_type = 'MONTH_ROLLING' ORDER BY period_end_date DESC LIMIT 1;",
        "rawQueryText": "SELECT CAST(json_extract(payload_json, '$.period_summary.totals.delta.total_market_value') AS REAL) AS value FROM snapshots WHERE period_type = 'MONTH_ROLLING' ORDER BY period_end_date DESC LIMIT 1;"
      }],
      "options": { "colorMode": "value", "graphMode": "none", "reduceOptions": { "calcs": ["lastNotNull"], "fields": "value", "values": false }, "textMode": "value_and_name" },
      "fieldConfig": { "defaults": { "unit": "currencyUSD", "decimals": 0, "thresholds": { "mode": "absolute", "steps": [{ "value": null, "color": "red" }, { "value": 0, "color": "green" }] } }, "overrides": [] }
    },
    {
      "id": 7,
      "type": "stat",
      "title": "MTD Income Delta",
      "gridPos": { "x": 12, "y": 6, "w": 6, "h": 4 },
      "datasource": { "type": "frser-sqlite-datasource", "uid": "lmi_sqlite" },
      "targets": [{ "refId": "A", "format": "table", "queryType": "table",
        "queryText": "SELECT CAST(json_extract(payload_json, '$.period_summary.income.delta.projected_monthly_income') AS REAL) AS value FROM snapshots WHERE period_type = 'MONTH_ROLLING' ORDER BY period_end_date DESC LIMIT 1;",
        "rawQueryText": "SELECT CAST(json_extract(payload_json, '$.period_summary.income.delta.projected_monthly_income') AS REAL) AS value FROM snapshots WHERE period_type = 'MONTH_ROLLING' ORDER BY period_end_date DESC LIMIT 1;"
      }],
      "options": { "colorMode": "value", "graphMode": "none", "reduceOptions": { "calcs": ["lastNotNull"], "fields": "value", "values": false }, "textMode": "value_and_name" },
      "fieldConfig": { "defaults": { "unit": "currencyUSD", "decimals": 0, "thresholds": { "mode": "absolute", "steps": [{ "value": null, "color": "red" }, { "value": 0, "color": "green" }] } }, "overrides": [] }
    },
    {
      "id": 8,
      "type": "stat",
      "title": "MTD TWR %",
      "gridPos": { "x": 18, "y": 6, "w": 6, "h": 4 },
      "datasource": { "type": "frser-sqlite-datasource", "uid": "lmi_sqlite" },
      "targets": [{ "refId": "A", "format": "table", "queryType": "table",
        "queryText": "SELECT CAST(json_extract(payload_json, '$.period_summary.performance.period.twr_period_pct') AS REAL) AS value FROM snapshots WHERE period_type = 'MONTH_ROLLING' ORDER BY period_end_date DESC LIMIT 1;",
        "rawQueryText": "SELECT CAST(json_extract(payload_json, '$.period_summary.performance.period.twr_period_pct') AS REAL) AS value FROM snapshots WHERE period_type = 'MONTH_ROLLING' ORDER BY period_end_date DESC LIMIT 1;"
      }],
      "options": { "colorMode": "value", "graphMode": "none", "reduceOptions": { "calcs": ["lastNotNull"], "fields": "value", "values": false }, "textMode": "value_and_name" },
      "fieldConfig": { "defaults": { "unit": "percent", "decimals": 2, "thresholds": { "mode": "absolute", "steps": [{ "value": null, "color": "red" }, { "value": 0, "color": "green" }] } }, "overrides": [] }
    },
    {
      "id": 102,
      "type": "row",
      "title": "Quarter-to-Date",
      "gridPos": { "x": 0, "y": 10, "w": 24, "h": 1 },
      "collapsed": false
    },
    {
      "id": 9,
      "type": "stat",
      "title": "QTD Range",
      "gridPos": { "x": 0, "y": 11, "w": 6, "h": 4 },
      "datasource": { "type": "frser-sqlite-datasource", "uid": "lmi_sqlite" },
      "targets": [{ "refId": "A", "format": "table", "queryType": "table",
        "queryText": "SELECT period_start_date || '  ->  ' || period_end_date AS value FROM snapshots WHERE period_type = 'QUARTER_ROLLING' ORDER BY period_end_date DESC LIMIT 1;",
        "rawQueryText": "SELECT period_start_date || '  ->  ' || period_end_date AS value FROM snapshots WHERE period_type = 'QUARTER_ROLLING' ORDER BY period_end_date DESC LIMIT 1;"
      }],
      "fieldConfig": { "defaults": {}, "overrides": [] }
    },
    {
      "id": 10,
      "type": "stat",
      "title": "QTD MV Delta",
      "gridPos": { "x": 6, "y": 11, "w": 6, "h": 4 },
      "datasource": { "type": "frser-sqlite-datasource", "uid": "lmi_sqlite" },
      "targets": [{ "refId": "A", "format": "table", "queryType": "table",
        "queryText": "SELECT CAST(json_extract(payload_json, '$.period_summary.totals.delta.total_market_value') AS REAL) AS value FROM snapshots WHERE period_type = 'QUARTER_ROLLING' ORDER BY period_end_date DESC LIMIT 1;",
        "rawQueryText": "SELECT CAST(json_extract(payload_json, '$.period_summary.totals.delta.total_market_value') AS REAL) AS value FROM snapshots WHERE period_type = 'QUARTER_ROLLING' ORDER BY period_end_date DESC LIMIT 1;"
      }],
      "options": { "colorMode": "value", "graphMode": "none", "reduceOptions": { "calcs": ["lastNotNull"], "fields": "value", "values": false }, "textMode": "value_and_name" },
      "fieldConfig": { "defaults": { "unit": "currencyUSD", "decimals": 0, "thresholds": { "mode": "absolute", "steps": [{ "value": null, "color": "red" }, { "value": 0, "color": "green" }] } }, "overrides": [] }
    },
    {
      "id": 11,
      "type": "stat",
      "title": "QTD Income Delta",
      "gridPos": { "x": 12, "y": 11, "w": 6, "h": 4 },
      "datasource": { "type": "frser-sqlite-datasource", "uid": "lmi_sqlite" },
      "targets": [{ "refId": "A", "format": "table", "queryType": "table",
        "queryText": "SELECT CAST(json_extract(payload_json, '$.period_summary.income.delta.projected_monthly_income') AS REAL) AS value FROM snapshots WHERE period_type = 'QUARTER_ROLLING' ORDER BY period_end_date DESC LIMIT 1;",
        "rawQueryText": "SELECT CAST(json_extract(payload_json, '$.period_summary.income.delta.projected_monthly_income') AS REAL) AS value FROM snapshots WHERE period_type = 'QUARTER_ROLLING' ORDER BY period_end_date DESC LIMIT 1;"
      }],
      "options": { "colorMode": "value", "graphMode": "none", "reduceOptions": { "calcs": ["lastNotNull"], "fields": "value", "values": false }, "textMode": "value_and_name" },
      "fieldConfig": { "defaults": { "unit": "currencyUSD", "decimals": 0, "thresholds": { "mode": "absolute", "steps": [{ "value": null, "color": "red" }, { "value": 0, "color": "green" }] } }, "overrides": [] }
    },
    {
      "id": 12,
      "type": "stat",
      "title": "QTD TWR %",
      "gridPos": { "x": 18, "y": 11, "w": 6, "h": 4 },
      "datasource": { "type": "frser-sqlite-datasource", "uid": "lmi_sqlite" },
      "targets": [{ "refId": "A", "format": "table", "queryType": "table",
        "queryText": "SELECT CAST(json_extract(payload_json, '$.period_summary.performance.period.twr_period_pct') AS REAL) AS value FROM snapshots WHERE period_type = 'QUARTER_ROLLING' ORDER BY period_end_date DESC LIMIT 1;",
        "rawQueryText": "SELECT CAST(json_extract(payload_json, '$.period_summary.performance.period.twr_period_pct') AS REAL) AS value FROM snapshots WHERE period_type = 'QUARTER_ROLLING' ORDER BY period_end_date DESC LIMIT 1;"
      }],
      "options": { "colorMode": "value", "graphMode": "none", "reduceOptions": { "calcs": ["lastNotNull"], "fields": "value", "values": false }, "textMode": "value_and_name" },
      "fieldConfig": { "defaults": { "unit": "percent", "decimals": 2, "thresholds": { "mode": "absolute", "steps": [{ "value": null, "color": "red" }, { "value": 0, "color": "green" }] } }, "overrides": [] }
    },
    {
      "id": 103,
      "type": "row",
      "title": "Year-to-Date",
      "gridPos": { "x": 0, "y": 15, "w": 24, "h": 1 },
      "collapsed": false
    },
    {
      "id": 13,
      "type": "stat",
      "title": "YTD Range",
      "gridPos": { "x": 0, "y": 16, "w": 6, "h": 4 },
      "datasource": { "type": "frser-sqlite-datasource", "uid": "lmi_sqlite" },
      "targets": [{ "refId": "A", "format": "table", "queryType": "table",
        "queryText": "SELECT period_start_date || '  ->  ' || period_end_date AS value FROM snapshots WHERE period_type = 'YEAR_ROLLING' ORDER BY period_end_date DESC LIMIT 1;",
        "rawQueryText": "SELECT period_start_date || '  ->  ' || period_end_date AS value FROM snapshots WHERE period_type = 'YEAR_ROLLING' ORDER BY period_end_date DESC LIMIT 1;"
      }],
      "fieldConfig": { "defaults": {}, "overrides": [] }
    },
    {
      "id": 14,
      "type": "stat",
      "title": "YTD MV Delta",
      "gridPos": { "x": 6, "y": 16, "w": 6, "h": 4 },
      "datasource": { "type": "frser-sqlite-datasource", "uid": "lmi_sqlite" },
      "targets": [{ "refId": "A", "format": "table", "queryType": "table",
        "queryText": "SELECT CAST(json_extract(payload_json, '$.period_summary.totals.delta.total_market_value') AS REAL) AS value FROM snapshots WHERE period_type = 'YEAR_ROLLING' ORDER BY period_end_date DESC LIMIT 1;",
        "rawQueryText": "SELECT CAST(json_extract(payload_json, '$.period_summary.totals.delta.total_market_value') AS REAL) AS value FROM snapshots WHERE period_type = 'YEAR_ROLLING' ORDER BY period_end_date DESC LIMIT 1;"
      }],
      "options": { "colorMode": "value", "graphMode": "none", "reduceOptions": { "calcs": ["lastNotNull"], "fields": "value", "values": false }, "textMode": "value_and_name" },
      "fieldConfig": { "defaults": { "unit": "currencyUSD", "decimals": 0, "thresholds": { "mode": "absolute", "steps": [{ "value": null, "color": "red" }, { "value": 0, "color": "green" }] } }, "overrides": [] }
    },
    {
      "id": 15,
      "type": "stat",
      "title": "YTD Income Delta",
      "gridPos": { "x": 12, "y": 16, "w": 6, "h": 4 },
      "datasource": { "type": "frser-sqlite-datasource", "uid": "lmi_sqlite" },
      "targets": [{ "refId": "A", "format": "table", "queryType": "table",
        "queryText": "SELECT CAST(json_extract(payload_json, '$.period_summary.income.delta.projected_monthly_income') AS REAL) AS value FROM snapshots WHERE period_type = 'YEAR_ROLLING' ORDER BY period_end_date DESC LIMIT 1;",
        "rawQueryText": "SELECT CAST(json_extract(payload_json, '$.period_summary.income.delta.projected_monthly_income') AS REAL) AS value FROM snapshots WHERE period_type = 'YEAR_ROLLING' ORDER BY period_end_date DESC LIMIT 1;"
      }],
      "options": { "colorMode": "value", "graphMode": "none", "reduceOptions": { "calcs": ["lastNotNull"], "fields": "value", "values": false }, "textMode": "value_and_name" },
      "fieldConfig": { "defaults": { "unit": "currencyUSD", "decimals": 0, "thresholds": { "mode": "absolute", "steps": [{ "value": null, "color": "red" }, { "value": 0, "color": "green" }] } }, "overrides": [] }
    },
    {
      "id": 16,
      "type": "stat",
      "title": "YTD TWR %",
      "gridPos": { "x": 18, "y": 16, "w": 6, "h": 4 },
      "datasource": { "type": "frser-sqlite-datasource", "uid": "lmi_sqlite" },
      "targets": [{ "refId": "A", "format": "table", "queryType": "table",
        "queryText": "SELECT CAST(json_extract(payload_json, '$.period_summary.performance.period.twr_period_pct') AS REAL) AS value FROM snapshots WHERE period_type = 'YEAR_ROLLING' ORDER BY period_end_date DESC LIMIT 1;",
        "rawQueryText": "SELECT CAST(json_extract(payload_json, '$.period_summary.performance.period.twr_period_pct') AS REAL) AS value FROM snapshots WHERE period_type = 'YEAR_ROLLING' ORDER BY period_end_date DESC LIMIT 1;"
      }],
      "options": { "colorMode": "value", "graphMode": "none", "reduceOptions": { "calcs": ["lastNotNull"], "fields": "value", "values": false }, "textMode": "value_and_name" },
      "fieldConfig": { "defaults": { "unit": "percent", "decimals": 2, "thresholds": { "mode": "absolute", "steps": [{ "value": null, "color": "red" }, { "value": 0, "color": "green" }] } }, "overrides": [] }
    },
    {
      "id": 104,
      "type": "row",
      "title": "Comparison Tables",
      "gridPos": { "x": 0, "y": 20, "w": 24, "h": 1 },
      "collapsed": false
    },
    {
      "id": 17,
      "type": "table",
      "title": "Rolling Period Summary",
      "gridPos": { "x": 0, "y": 21, "w": 24, "h": 10 },
      "datasource": { "type": "frser-sqlite-datasource", "uid": "lmi_sqlite" },
      "targets": [{ "refId": "A", "format": "table", "queryType": "table",
        "queryText": "SELECT REPLACE(REPLACE(REPLACE(REPLACE(s.period_type, 'WEEK_ROLLING', 'WTD'), 'MONTH_ROLLING', 'MTD'), 'QUARTER_ROLLING', 'QTD'), 'YEAR_ROLLING', 'YTD') AS period, s.period_start_date || ' -> ' || s.period_end_date AS range, CAST(json_extract(s.payload_json, '$.period_summary.totals.end.total_market_value') AS REAL) AS end_mv, CAST(json_extract(s.payload_json, '$.period_summary.totals.delta.total_market_value') AS REAL) AS mv_delta, CAST(json_extract(s.payload_json, '$.period_summary.income.end.projected_monthly_income') AS REAL) AS end_income, CAST(json_extract(s.payload_json, '$.period_summary.income.delta.projected_monthly_income') AS REAL) AS income_delta, CAST(json_extract(s.payload_json, '$.period_summary.performance.period.twr_period_pct') AS REAL) AS twr_pct, CAST(json_extract(s.payload_json, '$.period_summary.performance.period.pnl_dollar_period') AS REAL) AS pnl, CAST(json_extract(s.payload_json, '$.period_summary.goal_progress.delta.progress_pct') AS REAL) AS goal_delta_pct, CAST(json_extract(s.payload_json, '$.period_summary.composition.end.holding_count') AS INTEGER) AS holdings FROM snapshots s WHERE s.period_type IN ('WEEK_ROLLING', 'MONTH_ROLLING', 'QUARTER_ROLLING', 'YEAR_ROLLING') AND s.period_end_date = (SELECT MAX(s2.period_end_date) FROM snapshots s2 WHERE s2.period_type = s.period_type) ORDER BY CASE s.period_type WHEN 'WEEK_ROLLING' THEN 1 WHEN 'MONTH_ROLLING' THEN 2 WHEN 'QUARTER_ROLLING' THEN 3 WHEN 'YEAR_ROLLING' THEN 4 END;",
        "rawQueryText": "SELECT REPLACE(REPLACE(REPLACE(REPLACE(s.period_type, 'WEEK_ROLLING', 'WTD'), 'MONTH_ROLLING', 'MTD'), 'QUARTER_ROLLING', 'QTD'), 'YEAR_ROLLING', 'YTD') AS period, s.period_start_date || ' -> ' || s.period_end_date AS range, CAST(json_extract(s.payload_json, '$.period_summary.totals.end.total_market_value') AS REAL) AS end_mv, CAST(json_extract(s.payload_json, '$.period_summary.totals.delta.total_market_value') AS REAL) AS mv_delta, CAST(json_extract(s.payload_json, '$.period_summary.income.end.projected_monthly_income') AS REAL) AS end_income, CAST(json_extract(s.payload_json, '$.period_summary.income.delta.projected_monthly_income') AS REAL) AS income_delta, CAST(json_extract(s.payload_json, '$.period_summary.performance.period.twr_period_pct') AS REAL) AS twr_pct, CAST(json_extract(s.payload_json, '$.period_summary.performance.period.pnl_dollar_period') AS REAL) AS pnl, CAST(json_extract(s.payload_json, '$.period_summary.goal_progress.delta.progress_pct') AS REAL) AS goal_delta_pct, CAST(json_extract(s.payload_json, '$.period_summary.composition.end.holding_count') AS INTEGER) AS holdings FROM snapshots s WHERE s.period_type IN ('WEEK_ROLLING', 'MONTH_ROLLING', 'QUARTER_ROLLING', 'YEAR_ROLLING') AND s.period_end_date = (SELECT MAX(s2.period_end_date) FROM snapshots s2 WHERE s2.period_type = s.period_type) ORDER BY CASE s.period_type WHEN 'WEEK_ROLLING' THEN 1 WHEN 'MONTH_ROLLING' THEN 2 WHEN 'QUARTER_ROLLING' THEN 3 WHEN 'YEAR_ROLLING' THEN 4 END;"
      }],
      "options": { "showHeader": true, "cellHeight": "md" },
      "fieldConfig": {
        "defaults": {},
        "overrides": [
          { "matcher": { "id": "byName", "options": "period" }, "properties": [{ "id": "displayName", "value": "Period" }] },
          { "matcher": { "id": "byName", "options": "range" }, "properties": [{ "id": "displayName", "value": "Range" }] },
          { "matcher": { "id": "byName", "options": "end_mv" }, "properties": [{ "id": "unit", "value": "currencyUSD" }, { "id": "decimals", "value": 0 }, { "id": "displayName", "value": "End MV" }] },
          { "matcher": { "id": "byName", "options": "mv_delta" }, "properties": [{ "id": "unit", "value": "currencyUSD" }, { "id": "decimals", "value": 0 }, { "id": "displayName", "value": "MV Delta" }] },
          { "matcher": { "id": "byName", "options": "end_income" }, "properties": [{ "id": "unit", "value": "currencyUSD" }, { "id": "decimals", "value": 0 }, { "id": "displayName", "value": "End Income" }] },
          { "matcher": { "id": "byName", "options": "income_delta" }, "properties": [{ "id": "unit", "value": "currencyUSD" }, { "id": "decimals", "value": 0 }, { "id": "displayName", "value": "Income Delta" }] },
          { "matcher": { "id": "byName", "options": "twr_pct" }, "properties": [{ "id": "unit", "value": "percent" }, { "id": "decimals", "value": 2 }, { "id": "displayName", "value": "TWR %" }] },
          { "matcher": { "id": "byName", "options": "pnl" }, "properties": [{ "id": "unit", "value": "currencyUSD" }, { "id": "decimals", "value": 0 }, { "id": "displayName", "value": "P&L $" }] },
          { "matcher": { "id": "byName", "options": "goal_delta_pct" }, "properties": [{ "id": "unit", "value": "percent" }, { "id": "decimals", "value": 2 }, { "id": "displayName", "value": "Goal Progress Delta" }] },
          { "matcher": { "id": "byName", "options": "holdings" }, "properties": [{ "id": "displayName", "value": "Holdings" }] }
        ]
      }
    },
    {
      "id": 18,
      "type": "table",
      "title": "Rolling Risk Comparison",
      "gridPos": { "x": 0, "y": 31, "w": 24, "h": 10 },
      "datasource": { "type": "frser-sqlite-datasource", "uid": "lmi_sqlite" },
      "targets": [{ "refId": "A", "format": "table", "queryType": "table",
        "queryText": "SELECT REPLACE(REPLACE(REPLACE(REPLACE(s.period_type, 'WEEK_ROLLING', 'WTD'), 'MONTH_ROLLING', 'MTD'), 'QUARTER_ROLLING', 'QTD'), 'YEAR_ROLLING', 'YTD') AS period, CAST(json_extract(s.payload_json, '$.period_summary.risk.end.vol_30d_pct') AS REAL) AS vol_30d, CAST(json_extract(s.payload_json, '$.period_summary.risk.delta.vol_30d_pct') AS REAL) AS vol_delta, CAST(json_extract(s.payload_json, '$.period_summary.risk.end.sortino_1y') AS REAL) AS sortino, CAST(json_extract(s.payload_json, '$.period_summary.risk.delta.sortino_1y') AS REAL) AS sortino_delta, CAST(json_extract(s.payload_json, '$.period_summary.risk.end.sharpe_1y') AS REAL) AS sharpe, CAST(json_extract(s.payload_json, '$.period_summary.risk.delta.sharpe_1y') AS REAL) AS sharpe_delta, CAST(json_extract(s.payload_json, '$.period_summary.risk.end.max_drawdown_1y_pct') AS REAL) AS max_dd, CAST(json_extract(s.payload_json, '$.period_summary.risk.delta.max_drawdown_1y_pct') AS REAL) AS max_dd_delta, json_extract(s.payload_json, '$.period_summary.risk.end.portfolio_risk_quality') AS risk_quality FROM snapshots s WHERE s.period_type IN ('WEEK_ROLLING', 'MONTH_ROLLING', 'QUARTER_ROLLING', 'YEAR_ROLLING') AND s.period_end_date = (SELECT MAX(s2.period_end_date) FROM snapshots s2 WHERE s2.period_type = s.period_type) ORDER BY CASE s.period_type WHEN 'WEEK_ROLLING' THEN 1 WHEN 'MONTH_ROLLING' THEN 2 WHEN 'QUARTER_ROLLING' THEN 3 WHEN 'YEAR_ROLLING' THEN 4 END;",
        "rawQueryText": "SELECT REPLACE(REPLACE(REPLACE(REPLACE(s.period_type, 'WEEK_ROLLING', 'WTD'), 'MONTH_ROLLING', 'MTD'), 'QUARTER_ROLLING', 'QTD'), 'YEAR_ROLLING', 'YTD') AS period, CAST(json_extract(s.payload_json, '$.period_summary.risk.end.vol_30d_pct') AS REAL) AS vol_30d, CAST(json_extract(s.payload_json, '$.period_summary.risk.delta.vol_30d_pct') AS REAL) AS vol_delta, CAST(json_extract(s.payload_json, '$.period_summary.risk.end.sortino_1y') AS REAL) AS sortino, CAST(json_extract(s.payload_json, '$.period_summary.risk.delta.sortino_1y') AS REAL) AS sortino_delta, CAST(json_extract(s.payload_json, '$.period_summary.risk.end.sharpe_1y') AS REAL) AS sharpe, CAST(json_extract(s.payload_json, '$.period_summary.risk.delta.sharpe_1y') AS REAL) AS sharpe_delta, CAST(json_extract(s.payload_json, '$.period_summary.risk.end.max_drawdown_1y_pct') AS REAL) AS max_dd, CAST(json_extract(s.payload_json, '$.period_summary.risk.delta.max_drawdown_1y_pct') AS REAL) AS max_dd_delta, json_extract(s.payload_json, '$.period_summary.risk.end.portfolio_risk_quality') AS risk_quality FROM snapshots s WHERE s.period_type IN ('WEEK_ROLLING', 'MONTH_ROLLING', 'QUARTER_ROLLING', 'YEAR_ROLLING') AND s.period_end_date = (SELECT MAX(s2.period_end_date) FROM snapshots s2 WHERE s2.period_type = s.period_type) ORDER BY CASE s.period_type WHEN 'WEEK_ROLLING' THEN 1 WHEN 'MONTH_ROLLING' THEN 2 WHEN 'QUARTER_ROLLING' THEN 3 WHEN 'YEAR_ROLLING' THEN 4 END;"
      }],
      "options": { "showHeader": true, "cellHeight": "md" },
      "fieldConfig": {
        "defaults": { "decimals": 2 },
        "overrides": [
          { "matcher": { "id": "byName", "options": "period" }, "properties": [{ "id": "displayName", "value": "Period" }] },
          { "matcher": { "id": "byName", "options": "vol_30d" }, "properties": [{ "id": "unit", "value": "percent" }, { "id": "displayName", "value": "Vol 30d %" }] },
          { "matcher": { "id": "byName", "options": "vol_delta" }, "properties": [{ "id": "unit", "value": "percent" }, { "id": "displayName", "value": "Vol Delta" }] },
          { "matcher": { "id": "byName", "options": "sortino" }, "properties": [{ "id": "displayName", "value": "Sortino 1y" }] },
          { "matcher": { "id": "byName", "options": "sortino_delta" }, "properties": [{ "id": "displayName", "value": "Sortino Delta" }] },
          { "matcher": { "id": "byName", "options": "sharpe" }, "properties": [{ "id": "displayName", "value": "Sharpe 1y" }] },
          { "matcher": { "id": "byName", "options": "sharpe_delta" }, "properties": [{ "id": "displayName", "value": "Sharpe Delta" }] },
          { "matcher": { "id": "byName", "options": "max_dd" }, "properties": [{ "id": "unit", "value": "percent" }, { "id": "displayName", "value": "Max DD %" }] },
          { "matcher": { "id": "byName", "options": "max_dd_delta" }, "properties": [{ "id": "unit", "value": "percent" }, { "id": "displayName", "value": "DD Delta" }] },
          { "matcher": { "id": "byName", "options": "risk_quality" }, "properties": [{ "id": "displayName", "value": "Risk Quality" }] }
        ]
      }
    }
  ],
  "refresh": "2m",
  "schemaVersion": 39,
  "style": "dark",
  "tags": ["lmi", "periods"],
  "time": { "from": "now-90d", "to": "now" },
  "timezone": "browser",
  "title": "LMI - Rolling Periods (WTD/MTD/QTD/YTD)",
  "uid": "lmi-rolling-periods",
  "version": 1
}
